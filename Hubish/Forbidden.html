<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forbidden Experiment</title>
  <link rel="stylesheet" href="/css/Forbidden.css">
  <link rel="stylesheet" type="text/css" href="/css/backbutton.css">
</head>
<body>
  <div class="container">
    <!-- Header Section -->
    <header class="classified-header">
      <h1>CLASSIFIED: Project Hive</h1>
      <div class="header-line"></div>
    </header>

    <!-- Password Entry Section -->
    <div id="password-section">
      <h2>Enter Password to Access Terminal</h2>
      <input type="password" id="password-input" placeholder="Enter password here" />
      <button id="password-submit">Submit</button>
      <p id="password-error" class="error-message"></p> 
    </div>
    
    

    <!-- Terminal Section -->
    <div id="terminal-section" style="display: none;">
      <div class="content">
        <h2 class="subheading">Experiment Report</h2>
        <p class="intro-text">
          This document contains highly confidential information regarding <span class="highlight">Project Hive</span>. 
          Unauthorized access will result in immediate termination of connection. Proceed with caution.
        </p>

        <div class="terminal">
          <div class="terminal-header">
            <span class="terminal-title">Terminal Access</span>
          </div>
          <div class="terminal-body" id="terminal-body">
            <p>> Welcome to the Hive Terminal. Type 'HELP' to get help.</p>
          </div>
          <div class="terminal-input">
            <span>> </span>
            <input type="text" id="terminal-input" autocomplete="off" />
          </div>
        </div>        
      </div>
    </div>

    <!-- Footer Section -->
    <footer class="classified-footer">
      <p>Confidential: All activity on this page is monitored. Unauthorized access will be reported.</p>
    </footer>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const passwordSection = document.getElementById("password-section");
      const terminalSection = document.getElementById("terminal-section");
      const passwordInput = document.getElementById("password-input");
      const passwordSubmit = document.getElementById("password-submit");
      const passwordError = document.getElementById("password-error");

      const terminalInput = document.getElementById("terminal-input");
      const terminalBody = document.getElementById("terminal-body");

      // Handle Password Submission
      passwordSubmit.addEventListener("click", async () => {
        const enteredPassword = passwordInput.value.trim();

        try {
          const response = await fetch("https://roboguns-github-io.onrender.com/api/validate-password", {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({ password: enteredPassword })
          });

          if (response.ok) {
            const result = await response.json();
            if (result.success) {
              // Hide the password section and show the terminal
              passwordSection.style.display = "none";
              terminalSection.style.display = "block";
            }
          } else {
            throw new Error("Incorrect password");
          }
        } catch (error) {
          passwordError.textContent = "Incorrect password. Try again.";
        }
      });

       // Handle Terminal Commands
  terminalInput.addEventListener("keydown", async (event) => {
    if (event.key === "Enter") {
      const command = terminalInput.value.trim();

      if (!command) return; // Ignore empty commands

      // Display the entered command in the terminal
      const userCommand = document.createElement("p");
      userCommand.textContent = `> ${command}`;
      terminalBody.appendChild(userCommand);

      try {
        const response = await fetch(`https://roboguns-github-io.onrender.com/api/terminal?command=${encodeURIComponent(command)}`);
        const result = await response.json();

        // Display the server's response in the terminal
        const serverResponse = document.createElement("p");
        serverResponse.textContent = `> ${result.response}`;
        terminalBody.appendChild(serverResponse);
      } catch (error) {
        const errorResponse = document.createElement("p");
        errorResponse.textContent = "> Error: Unable to process the command.";
        errorResponse.style.color = "red";
        terminalBody.appendChild(errorResponse);
      }

      // Clear the input field
      terminalInput.value = "";

      // Scroll to the bottom of the terminal
      terminalBody.scrollTop = terminalBody.scrollHeight;
    }
  });
});

  </script>
</body>
</html>
